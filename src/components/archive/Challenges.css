import React, { useEffect, useState } from "react";
import { apiGetUserChallenges } from "../api";

function Challenges({ username }) {
  const [challenges, setChallenges] = useState([]);
  const [completed, setCompleted] = useState([]);

  useEffect(() => {
    if (username) {
      apiGetUserChallenges(username).then((data) => {
        if (data) {
          setChallenges(data.challenges || []);
          setCompleted(data.completed || []);
        }
      });
    }
  }, [username]);

  return (
    <div className="card">
      <h2>ðŸŽ¯ Challenges</h2>
      <ul>
        {challenges.map((c) => {
          const isDone = completed.find((cc) => cc.id === c.id);
          return (
            <li
              key={c.id}
              style={{
                marginBottom: "10px",
                color: isDone ? "lime" : "white",
              }}
            >
              <strong>{c.title}</strong> â†’ Reward:{" "}
              {c.reward > 0 ? `+${c.reward} pts` : c.badge}
              {isDone && " âœ… Completed!"}
            </li>
          );
        })}
      </ul>
    </div>
  );
}

export default Challenges;

